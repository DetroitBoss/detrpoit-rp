{"id":"w745","dependencies":[{"name":"D:\\DETROIT\\server\\tsconfig.json","includedInParent":true,"mtime":1660943058000},{"name":"D:\\DETROIT\\server\\.babelrc","includedInParent":true,"mtime":1660943058000},{"name":"D:\\DETROIT\\server\\package.json","includedInParent":true,"mtime":1697927911090},{"name":"react","loc":{"line":1,"column":33,"index":33},"parent":"D:\\DETROIT\\server\\src\\cef\\components\\Boombox\\index.tsx","resolved":"D:\\DETROIT\\server\\node_modules\\react\\index.js"},{"name":"../../modules/custom.event","loc":{"line":2,"column":28,"index":71},"parent":"D:\\DETROIT\\server\\src\\cef\\components\\Boombox\\index.tsx","resolved":"D:\\DETROIT\\server\\src\\cef\\modules\\custom.event.ts"},{"name":"./style.less","loc":{"line":3,"column":7,"index":109},"parent":"D:\\DETROIT\\server\\src\\cef\\components\\Boombox\\index.tsx","resolved":"D:\\DETROIT\\server\\src\\cef\\components\\Boombox\\style.less"},{"name":"../../modules/CEF","loc":{"line":4,"column":20,"index":146},"parent":"D:\\DETROIT\\server\\src\\cef\\components\\Boombox\\index.tsx","resolved":"D:\\DETROIT\\server\\src\\cef\\modules\\CEF.ts"},{"name":"../../modules/system","loc":{"line":5,"column":23,"index":191},"parent":"D:\\DETROIT\\server\\src\\cef\\components\\Boombox\\index.tsx","resolved":"D:\\DETROIT\\server\\src\\cef\\modules\\system.ts"},{"name":"./images/*.svg","loc":{"line":6,"column":16,"index":232},"parent":"D:\\DETROIT\\server\\src\\cef\\components\\Boombox\\index.tsx","resolved":"D:\\DETROIT\\server\\src\\cef\\components\\Boombox\\images\\*.svg"},{"name":"./images/*.gif","loc":{"line":7,"column":16,"index":267},"parent":"D:\\DETROIT\\server\\src\\cef\\components\\Boombox\\index.tsx","resolved":"D:\\DETROIT\\server\\src\\cef\\components\\Boombox\\images\\*.gif"},{"name":"../HudBlock/images/svg/close.svg","loc":{"line":8,"column":18,"index":304},"parent":"D:\\DETROIT\\server\\src\\cef\\components\\Boombox\\index.tsx","resolved":"D:\\DETROIT\\server\\src\\cef\\components\\HudBlock\\images\\svg\\close.svg"},{"name":"../SocketSync","loc":{"line":9,"column":27,"index":368},"parent":"D:\\DETROIT\\server\\src\\cef\\components\\Boombox\\index.tsx","resolved":"D:\\DETROIT\\server\\src\\cef\\components\\SocketSync\\index.tsx"},{"name":"@material-ui/core/styles","loc":{"line":10,"column":41,"index":427},"parent":"D:\\DETROIT\\server\\src\\cef\\components\\Boombox\\index.tsx","resolved":"D:\\DETROIT\\server\\node_modules\\@material-ui\\core\\esm\\styles\\index.js"},{"name":"@material-ui/core/Slider","loc":{"line":11,"column":19,"index":475},"parent":"D:\\DETROIT\\server\\src\\cef\\components\\Boombox\\index.tsx","resolved":"D:\\DETROIT\\server\\node_modules\\@material-ui\\core\\esm\\Slider\\index.js"}],"generated":{"js":"\"use strict\";Object.defineProperty(exports,\"__esModule\",{value:!0}),exports.genRandArray=exports.Boombox=void 0;var e=m(require(\"react\")),t=require(\"../../modules/custom.event\");require(\"./style.less\");var a=require(\"../../modules/CEF\"),n=require(\"../../modules/system\"),l=c(require(\"./images/*.svg\")),r=c(require(\"./images/*.gif\")),u=c(require(\"../HudBlock/images/svg/close.svg\")),o=require(\"../SocketSync\"),i=require(\"@material-ui/core/styles\"),s=c(require(\"@material-ui/core/Slider\"));function c(e){return e&&e.__esModule?e:{default:e}}function d(e){if(\"function\"!=typeof WeakMap)return null;var t=new WeakMap,a=new WeakMap;return(d=function(e){return e?a:t})(e)}function m(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||\"object\"!=typeof e&&\"function\"!=typeof e)return{default:e};var a=d(t);if(a&&a.has(e))return a.get(e);var n={__proto__:null},l=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in e)if(\"default\"!==r&&{}.hasOwnProperty.call(e,r)){var u=l?Object.getOwnPropertyDescriptor(e,r):null;u&&(u.get||u.set)?Object.defineProperty(n,r,u):n[r]=e[r]}return n.default=e,a&&a.set(e,n),n}function f(e){return(f=\"function\"==typeof Symbol&&\"symbol\"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&\"function\"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?\"symbol\":typeof e})(e)}function p(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,n)}return a}function b(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?p(Object(a),!0).forEach(function(t){v(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):p(Object(a)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}function v(e,t,a){return(t=h(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function y(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}function g(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,h(n.key),n)}}function E(e,t,a){return t&&g(e.prototype,t),a&&g(e,a),Object.defineProperty(e,\"prototype\",{writable:!1}),e}function h(e){var t=S(e,\"string\");return\"symbol\"==f(t)?t:t+\"\"}function S(e,t){if(\"object\"!=f(e)||!e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var n=a.call(e,t||\"default\");if(\"object\"!=f(n))return n;throw new TypeError(\"@@toPrimitive must return a primitive value.\")}return(\"string\"===t?String:Number)(e)}function k(e,t,a){return t=F(t),N(e,C()?Reflect.construct(t,a||[],F(e).constructor):t.apply(e,a))}function N(e,t){if(t&&(\"object\"==f(t)||\"function\"==typeof t))return t;if(void 0!==t)throw new TypeError(\"Derived constructors may only return object or undefined\");return w(e)}function w(e){if(void 0===e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return e}function C(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(C=function(){return!!e})()}function F(e){return(F=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function D(e,t){if(\"function\"!=typeof t&&null!==t)throw new TypeError(\"Super expression must either be null or a function\");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,\"prototype\",{writable:!1}),t&&O(e,t)}function O(e,t){return(O=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var T=exports.genRandArray=function(e){for(var t=[],a=0;a<e;a++){var l=n.system.randomStr(7);t.push({id:l,name:l,duration:n.system.getRandomInt(120,250)})}return t},x=exports.Boombox=function(i){function s(e){var l;y(this,s);var r=T(15);return(l=k(this,s,[e])).state={volumeTimer:0,volume:100,public:!1,paused:!1,repeate:!1,rand:!1,url:\"\",loading:!1,show:a.CEF.test,id:a.CEF.test?\"123223\":\"0\",currentSong:a.CEF.test?{id:n.system.randomArrayElement(r).id,time:10}:null,playList:a.CEF.test?r:[],playListLast:a.CEF.test?T(55):[],playListMy:a.CEF.test?T(55):[]},l.ev=t.CustomEvent.register(\"boombox:init\",function(e){l.loadData(e)}),l.int=setInterval(function(){l.state.volumeTimer>0&&(100===l.state.volumeTimer&&l.sendTask(\"volume\",l.state.volume),l.setState({volumeTimer:l.state.volumeTimer-100})),l.currentSongData&&(l.state.paused||l.setState({currentSong:b(b({},l.state.currentSong),{},{time:Math.min(l.currentSongData.duration,l.state.currentSong.time+.1)})}))},100),l}return D(s,e.Component),E(s,[{key:\"setVolume\",value:function(e){this.setState({volume:e,volumeTimer:600})}},{key:\"loadData\",value:function(e){this.setState(b({show:!0},e))}},{key:\"componentWillUnmount\",value:function(){this.ev&&this.ev.destroy(),this.int&&clearInterval(this.int)}},{key:\"currentInputSongType\",get:function(){if(!this.state.url)return null;if(!this.state.url.includes(\"spotify\")&&(this.state.url.includes(\"youtube\")||this.state.url.includes(\"youtu.be\")))return\"spotify\";if(this.state.url.includes(\"spotify\")&&!this.state.url.includes(\"youtube\")&&!this.state.url.includes(\"youtu.be\"))return\"youtube\";if(0==this.state.url.toLowerCase().indexOf(\"w\")){var e=String(this.state.url),t=parseInt(e.substr(1));if(t&&!isNaN(t)&&t>0&&t<9999999999)return\"player\"}return null}},{key:\"currentSongData\",get:function(){var e=this;return this.state.currentSong?this.state.playList.find(function(t){return t.id===e.state.currentSong.id}):null}},{key:\"sendTask\",value:function(e){for(var a=arguments.length,n=new Array(a>1?a-1:0),l=1;l<a;l++)n[l-1]=arguments[l];t.CustomEvent.triggerServer.apply(t.CustomEvent,[\"boombox:task\",this.state.id,e].concat(n))}},{key:\"render\",value:function(){var i=this;return this.state.show?e.default.createElement(\"section\",{className:\"boombox-section\"},e.default.createElement(o.SocketSync,{path:\"boombox_\".concat(this.state.id),data:function(e){if(!e)return a.CEF.gui.setGui(null);i.loadData(JSON.parse(e))}},e.default.createElement(\"button\",{className:\"all-close\",onClick:function(e){a.CEF.gui.setGui(null)}},e.default.createElement(\"div\",null,e.default.createElement(\"img\",{src:u.default,alt:\"\"})),e.default.createElement(\"p\",null,\"Закрыть\")),e.default.createElement(\"div\",{className:\"boombox-wrapper\"},e.default.createElement(\"button\",{className:\"boombox-take\",onClick:function(e){e.preventDefault(),a.CEF.gui.setGui(null),t.CustomEvent.triggerServer(\"boombox:take\",i.state.id)}},e.default.createElement(\"p\",null,\"Забрать плеер\")),e.default.createElement(\"div\",{className:\"boom-topline\"},e.default.createElement(\"div\",{className:\"boom-input\"},e.default.createElement(\"i\",{className:\"boom-faq\"},e.default.createElement(\"img\",{src:l.default.question,alt:\"\"})),e.default.createElement(\"div\",{className:\"boom-music-icons\"},e.default.createElement(\"i\",{className:\"\".concat(\"spotify\"==this.currentInputSongType||\"player\"==this.currentInputSongType?this.state.loading?\"disabled\":\"hide\":\"\")},e.default.createElement(\"img\",{src:l.default.spotify,alt:\"\"})),e.default.createElement(\"i\",{className:\"\".concat(\"youtube\"==this.currentInputSongType||\"player\"==this.currentInputSongType?this.state.loading?\"disabled\":\"hide\":\"\")},e.default.createElement(\"img\",{src:l.default.youtube,alt:\"\"})),e.default.createElement(\"i\",{className:\"\".concat(this.state.loading?\"\":\"disabled\")},e.default.createElement(\"img\",{src:r.default.load,alt:\"\"}))),this.state.loading?e.default.createElement(e.default.Fragment,null,e.default.createElement(\"input\",{type:\"text\",disabled:!0,value:\"Загрузка вашей композиции . . .\"})):e.default.createElement(e.default.Fragment,null,e.default.createElement(\"input\",{type:\"text\",placeholder:\"URL композиции в Spotify, Youtube или ID плейлиста\",value:this.state.url,onChange:function(e){e.preventDefault(),i.setState({url:e.currentTarget.value})}}))),e.default.createElement(\"button\",{disabled:this.state.loading||!this.currentInputSongType,onClick:function(e){if(e.preventDefault(),!i.state.loading&&i.currentInputSongType){if(\"player\"===i.currentInputSongType&&i.state.url.substr(1)===i.state.id.toString())return a.CEF.alert.setAlert(\"error\",\"Указанный ID совпадает с текущим\");i.setState({loading:!0}),t.CustomEvent.callServer(\"boombox:load\",i.state.id,i.currentInputSongType,i.state.url).then(function(e){return i.setState({loading:!1})})}}},this.state.loading?\"\":e.default.createElement(\"img\",{src:l.default.add,alt:\"\"}),e.default.createElement(\"p\",null,this.state.loading?\"Загрузка\":\"Добавить\"))),e.default.createElement(\"div\",{className:\"boom-playlist\"},e.default.createElement(\"div\",{className:\"boom-playlist-shadow\"}),e.default.createElement(\"div\",{className:\"boom-playlist-list-wrapper\"},e.default.createElement(\"div\",{className:\"boom-playlist-id\"},e.default.createElement(\"div\",null,e.default.createElement(\"p\",null,\"ID Плеера\"),e.default.createElement(\"p\",{className:\"bp-id\"},e.default.createElement(\"strong\",null,\"W\",this.state.id))),e.default.createElement(\"button\",{onClick:function(e){e.preventDefault(),a.CEF.alert.setAlert(\"info\",\"ID Плеера скопирован\"),a.CEF.copy(\"W\".concat(i.state.id))}},e.default.createElement(\"img\",{src:l.default.copy,alt:\"\"}))),e.default.createElement(\"div\",{className:\"boom-playlist-list\"},this.state.playList.map(function(t,a){return e.default.createElement(\"div\",{className:\"bp-item-wrap \"+(i.state.currentSong&&i.state.currentSong.id===t.id?\"play-item\":\"\"),key:\"playlist_play_\".concat(a)},e.default.createElement(\"div\",{className:\"bp-item\",onContextMenu:function(e){e.preventDefault(),i.setState({right:a})},onClick:function(e){e.preventDefault(),i.setState({right:null}),i.sendTask(\"load\",t.id)}},e.default.createElement(\"div\",null,e.default.createElement(\"p\",{className:\"bp-item-name\"},t.name),e.default.createElement(\"p\",{className:\"bp-item-time\"},n.system.secondsToString(t.duration)))),e.default.createElement(\"div\",{className:\"bp-item-manage\"},e.default.createElement(\"div\",{className:\"bp-delete \"+(i.state.right!==a?\"disabled\":\"\"),onClick:function(e){e.preventDefault(),i.setState({right:null}),i.sendTask(\"delete\",t.id)}},e.default.createElement(\"button\",null,e.default.createElement(\"img\",{src:l.default.trash,alt:\"\"}))),e.default.createElement(\"div\",{className:\"bp-position \"+(i.state.right===a?\"disabled\":\"\")},e.default.createElement(\"button\",{disabled:0==a,onClick:function(e){e.preventDefault(),i.sendTask(\"moveUp\",t.id)}},e.default.createElement(\"img\",{src:l.default.up,alt:\"\"})),e.default.createElement(\"button\",{disabled:a>=i.state.playList.length-1,onClick:function(e){e.preventDefault(),i.sendTask(\"moveDown\",t.id)}},e.default.createElement(\"img\",{src:l.default.down,alt:\"\"})))))})))),e.default.createElement(\"div\",{className:\"boom-content\"},e.default.createElement(\"div\",{className:\"boom-main-list-wrapper\"},e.default.createElement(\"p\",{className:\"boom-mini-title\"},\"Последние композиции\"),e.default.createElement(\"div\",{className:\"boom-main-list\"},this.state.playListLast.map(function(t,r){return e.default.createElement(\"div\",{className:\"bp-item mini\",key:\"playlist_last_\".concat(r)},e.default.createElement(\"div\",null,e.default.createElement(\"p\",{className:\"bp-item-name\"},t.name),e.default.createElement(\"p\",{className:\"bp-item-time\"},n.system.secondsToString(t.duration))),e.default.createElement(\"div\",{className:\"bp-item-buttons\"},e.default.createElement(\"button\",{className:\"bp-add\",onClick:function(e){e.preventDefault(),i.sendTask(\"load\",t.id)}},e.default.createElement(\"img\",{src:l.default.add,alt:\"\"})),a.CEF.admin?e.default.createElement(\"button\",{className:\"red\",onClick:function(e){e.preventDefault(),i.sendTask(\"block\",t.id)}},e.default.createElement(\"img\",{src:l.default.trash,alt:\"\"})):e.default.createElement(e.default.Fragment,null)))}))),e.default.createElement(\"div\",{className:\"boom-main-list-wrapper add-composition-list\"},e.default.createElement(\"p\",{className:\"boom-mini-title\"},\"Мои композиции\"),e.default.createElement(\"div\",{className:\"boom-main-list\"},this.state.playListMy.map(function(t,r){return e.default.createElement(\"div\",{className:\"bp-item mini\",key:\"playlist_lastmy_\".concat(r)},e.default.createElement(\"div\",null,e.default.createElement(\"p\",{className:\"bp-item-name\"},t.name),e.default.createElement(\"p\",{className:\"bp-item-time\"},n.system.secondsToString(t.duration))),e.default.createElement(\"div\",{className:\"bp-item-buttons\"},e.default.createElement(\"button\",{className:\"bp-add\",onClick:function(e){e.preventDefault(),i.sendTask(\"load\",t.id)}},e.default.createElement(\"img\",{src:l.default.add,alt:\"\"})),a.CEF.admin?e.default.createElement(\"button\",{className:\"red\",onClick:function(e){e.preventDefault(),i.sendTask(\"block\",t.id)}},e.default.createElement(\"img\",{src:l.default.trash,alt:\"\"})):e.default.createElement(e.default.Fragment,null)))})))),e.default.createElement(\"div\",{className:\"boom-botline\"},e.default.createElement(\"div\",{className:\"centered\"}),this.currentSongData?e.default.createElement(\"div\",{className:\"composition-progress\"},e.default.createElement(\"i\",{style:{width:\"\".concat(Math.min(100,this.state.currentSong.time/this.currentSongData.duration*100),\"%\")}})):e.default.createElement(e.default.Fragment,null),this.state.currentSong&&this.currentSongData?e.default.createElement(\"div\",{className:\"bbp-comp-name\"},e.default.createElement(\"p\",null,this.currentSongData.name),e.default.createElement(\"p\",{className:\"bbp-comp-time\"},n.system.secondsToString(this.state.currentSong.time),\" / \",n.system.secondsToString(this.currentSongData.duration))):e.default.createElement(e.default.Fragment,null),e.default.createElement(\"div\",{className:\"bbp-management\"},e.default.createElement(\"button\",{onClick:function(e){e.preventDefault(),i.sendTask(\"shuffle\")},className:\"bbp-button \"+(this.state.rand?\"\":\"off\")},e.default.createElement(\"img\",{src:l.default.shuffle,alt:\"\"})),e.default.createElement(\"button\",{onClick:function(e){e.preventDefault(),i.sendTask(\"prev\")},className:\"bbp-button\"},e.default.createElement(\"img\",{src:l.default.previous_track,alt:\"\"})),e.default.createElement(\"button\",{className:\"bbp-button bbp-play\",onClick:function(e){e.preventDefault(),i.currentSongData&&i.sendTask(\"paused\")}},e.default.createElement(\"img\",{src:l.default[this.state.paused||!this.currentSongData?\"play\":\"pause\"],alt:\"\"})),e.default.createElement(\"button\",{onClick:function(e){e.preventDefault(),i.sendTask(\"next\")},className:\"bbp-button\"},e.default.createElement(\"img\",{src:l.default.next_track,alt:\"\"})),e.default.createElement(\"button\",{onClick:function(e){e.preventDefault(),i.sendTask(\"repeate\")},className:\"bbp-button \"+(this.state.repeate?\"\":\"off\")},e.default.createElement(\"img\",{src:l.default.cycle_arrows,alt:\"\"})),e.default.createElement(\"button\",{onClick:function(e){e.preventDefault(),i.sendTask(\"private\")},className:\"bbp-button \"+(this.state.public?\"off\":\"\")},e.default.createElement(\"img\",{src:l.default.locked,alt:\"\"})),e.default.createElement(\"div\",{className:\"volume\"},j(this.state.volume,function(e,t){i.setVolume(t)},0,100,1),e.default.createElement(\"img\",{src:l.default.sound,alt:\"\"}))))))):e.default.createElement(e.default.Fragment,null)}}])}(),j=function(t,a){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:100,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;arguments.length>5&&void 0!==arguments[5]&&arguments[5],arguments.length>6&&void 0!==arguments[6]&&arguments[6];return e.default.createElement(P,{className:\"volume-size\",min:n,max:l,step:r,value:t,valueLabelDisplay:\"off\",onChange:function(e,n){n!=t&&a(e,n)}})},_=(0,i.createStyles)({colorPrimary:{color:\"#000000\"},rail:{color:\"#151a1d\"},root:{color:\"#C4C4C4\",height:26,padding:0},markLabel:{color:\"#FFFFFFaa\",fontSize:\"0.7vw\"},markLabelActive:{color:\"#FFFFFFee\"},thumb:{height:\"0.625vw\",width:\"0.625vw\",borderRadius:\"20px\",backgroundColor:\"#E3256B\",marginTop:-3,\"&:focus, &:hover, &$active\":{boxShadow:\"0px 0px 30px #E3256B\"}},track:{height:\"0.3125vw\",backgroundColor:\"#FFFFFF\",boxShadow:\"0px 0px 3px #FFFFFF\"}}),P=(0,i.withStyles)(_)(s.default);"},"sourceMaps":null,"error":null,"hash":"6854facc02a49d5f7b5d5b94393ecad8","cacheData":{"env":{}}}