{"id":"wYuI","dependencies":[{"name":"C:\\onyx_V2\\server\\tsconfig.json","includedInParent":true,"mtime":1660943058000},{"name":"C:\\onyx_V2\\server\\.babelrc","includedInParent":true,"mtime":1660943058000},{"name":"C:\\onyx_V2\\server\\package.json","includedInParent":true,"mtime":1697927911090},{"name":"react","loc":{"line":1,"column":33,"index":33},"parent":"C:\\onyx_V2\\server\\src\\cef\\components\\Shop\\index.tsx","resolved":"C:\\onyx_V2\\server\\node_modules\\react\\index.js"},{"name":"../../../shared/icons/*.png","loc":{"line":2,"column":18,"index":61},"parent":"C:\\onyx_V2\\server\\src\\cef\\components\\Shop\\index.tsx","resolved":"C:\\onyx_V2\\server\\src\\shared\\icons\\*.png"},{"name":"./style.less","loc":{"line":3,"column":7,"index":100},"parent":"C:\\onyx_V2\\server\\src\\cef\\components\\Shop\\index.tsx","resolved":"C:\\onyx_V2\\server\\src\\cef\\components\\Shop\\style.less"},{"name":"../../modules/custom.event","loc":{"line":4,"column":28,"index":145},"parent":"C:\\onyx_V2\\server\\src\\cef\\components\\Shop\\index.tsx","resolved":"C:\\onyx_V2\\server\\src\\cef\\modules\\custom.event.ts"},{"name":"../../../shared/inventory","loc":{"line":5,"column":94,"index":270},"parent":"C:\\onyx_V2\\server\\src\\cef\\components\\Shop\\index.tsx","resolved":"C:\\onyx_V2\\server\\src\\shared\\inventory.ts"},{"name":"../../../shared/business","loc":{"line":6,"column":39,"index":339},"parent":"C:\\onyx_V2\\server\\src\\cef\\components\\Shop\\index.tsx","resolved":"C:\\onyx_V2\\server\\src\\shared\\business.ts"},{"name":"./../Fuel/assets/bg.svg","loc":{"line":7,"column":15,"index":383},"parent":"C:\\onyx_V2\\server\\src\\cef\\components\\Shop\\index.tsx","resolved":"C:\\onyx_V2\\server\\src\\cef\\components\\Fuel\\assets\\bg.svg"},{"name":"./../ClothShop/assets/check.svg","loc":{"line":8,"column":18,"index":429},"parent":"C:\\onyx_V2\\server\\src\\cef\\components\\Shop\\index.tsx","resolved":"C:\\onyx_V2\\server\\src\\cef\\components\\ClothShop\\assets\\check.svg"},{"name":"./assets/cart.svg","loc":{"line":9,"column":17,"index":482},"parent":"C:\\onyx_V2\\server\\src\\cef\\components\\Shop\\index.tsx","resolved":"C:\\onyx_V2\\server\\src\\cef\\components\\Shop\\assets\\cart.svg"},{"name":"./assets/plus.svg","loc":{"line":10,"column":17,"index":521},"parent":"C:\\onyx_V2\\server\\src\\cef\\components\\Shop\\index.tsx","resolved":"C:\\onyx_V2\\server\\src\\cef\\components\\Shop\\assets\\plus.svg"},{"name":"./assets/minus.svg","loc":{"line":11,"column":18,"index":561},"parent":"C:\\onyx_V2\\server\\src\\cef\\components\\Shop\\index.tsx","resolved":"C:\\onyx_V2\\server\\src\\cef\\components\\Shop\\assets\\minus.svg"},{"name":"./assets/coin.svg","loc":{"line":12,"column":17,"index":601},"parent":"C:\\onyx_V2\\server\\src\\cef\\components\\Shop\\index.tsx","resolved":"C:\\onyx_V2\\server\\src\\cef\\components\\Shop\\assets\\coin.svg"},{"name":"../PayBox/PayBox","loc":{"line":13,"column":23,"index":646},"parent":"C:\\onyx_V2\\server\\src\\cef\\components\\Shop\\index.tsx","resolved":"C:\\onyx_V2\\server\\src\\cef\\components\\PayBox\\PayBox.tsx"},{"name":"../../modules/CEF","loc":{"line":14,"column":20,"index":687},"parent":"C:\\onyx_V2\\server\\src\\cef\\components\\Shop\\index.tsx","resolved":"C:\\onyx_V2\\server\\src\\cef\\modules\\CEF.ts"},{"name":"../Tooltip","loc":{"line":15,"column":29,"index":738},"parent":"C:\\onyx_V2\\server\\src\\cef\\components\\Shop\\index.tsx","resolved":"C:\\onyx_V2\\server\\src\\cef\\components\\Tooltip\\index.tsx"},{"name":"../HudBlock/images/svg/close.svg","loc":{"line":16,"column":18,"index":771},"parent":"C:\\onyx_V2\\server\\src\\cef\\components\\Shop\\index.tsx","resolved":"C:\\onyx_V2\\server\\src\\cef\\components\\HudBlock\\images\\svg\\close.svg"},{"name":"../../modules/system","loc":{"line":17,"column":23,"index":831},"parent":"C:\\onyx_V2\\server\\src\\cef\\components\\Shop\\index.tsx","resolved":"C:\\onyx_V2\\server\\src\\cef\\modules\\system.ts"}],"generated":{"js":"\"use strict\";Object.defineProperty(exports,\"__esModule\",{value:!0}),exports.ShopBlock=void 0;var e=v(require(\"react\")),t=h(require(\"../../../shared/icons/*.png\"));require(\"./style.less\");var n=require(\"../../modules/custom.event\"),r=require(\"../../../shared/inventory\"),a=require(\"../../../shared/business\"),o=h(require(\"./../Fuel/assets/bg.svg\")),i=h(require(\"./../ClothShop/assets/check.svg\")),l=h(require(\"./assets/cart.svg\")),u=h(require(\"./assets/plus.svg\")),s=h(require(\"./assets/minus.svg\")),c=h(require(\"./assets/coin.svg\")),f=require(\"../PayBox/PayBox\"),m=require(\"../../modules/CEF\"),d=require(\"../Tooltip\"),p=h(require(\"../HudBlock/images/svg/close.svg\")),y=require(\"../../modules/system\");function h(e){return e&&e.__esModule?e:{default:e}}function E(e){if(\"function\"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(E=function(e){return e?n:t})(e)}function v(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||\"object\"!=typeof e&&\"function\"!=typeof e)return{default:e};var n=E(t);if(n&&n.has(e))return n.get(e);var r={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(\"default\"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var i=a?Object.getOwnPropertyDescriptor(e,o):null;i&&(i.get||i.set)?Object.defineProperty(r,o,i):r[o]=e[o]}return r.default=e,n&&n.set(e,r),r}function b(e){return(b=\"function\"==typeof Symbol&&\"symbol\"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&\"function\"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?\"symbol\":typeof e})(e)}function g(e){return C(e)||O(e)||P(e)||_()}function _(){throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")}function P(e,t){if(e){if(\"string\"==typeof e)return w(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return\"Object\"===n&&e.constructor&&(n=e.constructor.name),\"Map\"===n||\"Set\"===n?Array.from(e):\"Arguments\"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?w(e,t):void 0}}function O(e){if(\"undefined\"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e[\"@@iterator\"])return Array.from(e)}function C(e){if(Array.isArray(e))return w(e)}function w(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function S(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function N(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?S(Object(n),!0).forEach(function(t){T(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):S(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function T(e,t,n){return(t=k(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function I(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,\"value\"in r&&(r.writable=!0),Object.defineProperty(e,k(r.key),r)}}function j(e,t,n){return t&&I(e.prototype,t),n&&I(e,n),Object.defineProperty(e,\"prototype\",{writable:!1}),e}function k(e){var t=A(e,\"string\");return\"symbol\"===b(t)?t:String(t)}function A(e,t){if(\"object\"!==b(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||\"default\");if(\"object\"!==b(r))return r;throw new TypeError(\"@@toPrimitive must return a primitive value.\")}return(\"string\"===t?String:Number)(e)}function M(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}function B(e,t){if(\"function\"!=typeof t&&null!==t)throw new TypeError(\"Super expression must either be null or a function\");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,\"prototype\",{writable:!1}),t&&q(e,t)}function q(e,t){return(q=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function x(e){var t=F();return function(){var n,r=W(e);if(t){var a=W(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return D(this,n)}}function D(e,t){if(t&&(\"object\"===b(t)||\"function\"==typeof t))return t;if(void 0!==t)throw new TypeError(\"Derived constructors may only return object or undefined\");return R(e)}function R(e){if(void 0===e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return e}function F(){if(\"undefined\"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(\"function\"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function W(e){return(W=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Y=exports.ShopBlock=function(h){B(v,e.Component);var E=x(v);function v(h){var b;return M(this,v),(b=E.call(this,h)).componentDidMount=function(){document.addEventListener(\"keydown\",b.handleKeyDown)},b.componentWillUnmount=function(){b.initEvent&&b.initEvent.destroy(),document.removeEventListener(\"keydown\",b.handleKeyDown)},b.handleKeyDown=function(e){switch(e.keyCode){case 27:return n.CustomEvent.triggerClient(\"shop::closeButton\"),void(b.state.showPay&&!0===b.state.showPay?b.setState(N(N({},b.state),{},{showPay:!1})):b.setState(N(N({},b.state),{},{active:!1})))}},b.buyItem=function(){var e=b.state.donate?{paytype:150,pin:\"\"}:b._child.current.canPay(b.getAllPrice());if(e){var t=g(b.state.items).filter(function(e){return e.inCart>0}).map(function(e){return[e.item_id,e.inCart]});0!==t.length&&(b.setState({showPay:!1}),n.CustomEvent.triggerServer(\"server:item_shop:buy_item\",b.state.shopId,t,e.paytype,e.pin))}},b.selectType=function(e){b.setState(N(N({},b.state),{},{selectType:e}))},b.putInCart=function(e,t){if(t>0&&b.state.items.find(function(t){return t.item_id===e}).count<=(b.state.items.find(function(t){return t.item_id===e}).inCart||0))return;var n=b.state.items.map(function(n){return n.item_id===e?N(N({},n),{},{inCart:n.inCart?n.inCart+t:t}):n});b.setState(N(N({},b.state),{},{items:n}))},b.getAllPrice=function(){var e=0;return b.state.items.map(function(t){t.inCart&&(e+=t.inCart*t.price)}),e},b.getCategorys=function(){var e=[];return b.state.items.map(function(t){var n=r.inventoryShared.get(t.item_id);if(!n)return console.log(\"getCategorys ITEM SHOP WRONG ITEM\");!1===e.some(function(e){return e.name===r.ITEM_TYPE_ARRAY[n.type]})&&e.push({index:n.type,name:r.ITEM_TYPE_ARRAY[n.type]})}),e},b.render=function(){var h=b.state,E=h.active,v=(h.name,b.state.items?b.state.items.filter(function(e){return e.inCart&&e.inCart>0}):[]),g=b.getCategorys(),_=b.state.items?b.state.items.filter(function(e){return r.inventoryShared.get(e.item_id)&&r.inventoryShared.get(e.item_id).type==g[b.state.selectType].index}):[];return E?e.default.createElement(\"div\",{className:\"shop_browser\"},e.default.createElement(\"div\",{className:\"shop_grid\"}),e.default.createElement(\"div\",{className:\"shop_bg\"},e.default.createElement(\"img\",{src:o.default})),e.default.createElement(\"div\",{className:\"shop_blur\"}),b.state.showPay&&!0===b.state.showPay?e.default.createElement(\"div\",{className:\"shop_paybox\"},e.default.createElement(\"div\",{className:\"shop_paybox_box\"},e.default.createElement(f.PayBox,{ref:b._child}),e.default.createElement(\"div\",{className:\"shop_buy\",onClick:b.buyItem},e.default.createElement(\"img\",{src:i.default}),\"Оплатить\"))):null,e.default.createElement(\"div\",{className:\"shop_main\"},e.default.createElement(\"button\",{className:\"all-close\",onClick:function(e){n.CustomEvent.triggerClient(\"shop::closeButton\"),m.CEF.gui.setGui(null)}},e.default.createElement(\"div\",null,e.default.createElement(\"img\",{src:p.default,alt:\"\"})),e.default.createElement(\"p\",null,\"Закрыть\")),e.default.createElement(\"h1\",null,a.BUSINESS_SUBTYPE_NAMES[b.state.shopType[0]][b.state.shopType[1]]),e.default.createElement(\"h2\",null,b.state.name),e.default.createElement(\"div\",{className:\"shop_box\"},e.default.createElement(\"div\",{className:\"shop_left\"},e.default.createElement(\"div\",{className:\"shop_types\"},g.length>1&&g.map(function(t,n){return e.default.createElement(\"div\",{key:n,className:\"shop_type \".concat(n==b.state.selectType?\"shop_type_select\":\"\"),onClick:function(){return b.selectType(n)}},t.name)}))),e.default.createElement(\"div\",{className:\"shop_center\"},_.map(function(a,o){var i=(0,r.getItemDesc)(a.item_id),l=r.inventoryShared.get(a.item_id),u=(r.ITEM_TYPE.WEAPON==l.type?r.inventoryShared.getWeaponConfigByItemId(a.item_id):r.ITEM_TYPE.WEAPON_MAGAZINE==l.type&&r.inventoryShared.getWeaponConfigByMagazine(a.item_id),e.default.createElement(\"div\",{key:o,className:\"shop_item \".concat(o==b.state.selectType?\"shop_item_select\":\"\"),onMouseEnter:function(){return b.setState(N(N({},b.state),{},{selectItem:o}))},onMouseLeave:function(){return b.setState(N(N({},b.state),{},{selectItem:-1}))},onClick:function(){return b.putInCart(a.item_id,1)}},e.default.createElement(\"div\",null,e.default.createElement(\"img\",{src:t.default[\"Item_\"+a.item_id],alt:\"\"})),e.default.createElement(\"p\",null,(0,r.getBaseItemNameById)(a.item_id)),[r.ITEM_TYPE.WATER,r.ITEM_TYPE.FOOD].includes(l.type)?e.default.createElement(\"p\",{className:\"desc\"},\"Объём: \",l.default_count,\" \",l.type==r.ITEM_TYPE.WATER?\"мл\":\"гр\"):e.default.createElement(e.default.Fragment,null),e.default.createElement(\"h3\",null,b.state.donate?e.default.createElement(\"img\",{className:\"shop-logo__coin\",src:c.default}):\"$\",a.price),l.type===r.ITEM_TYPE.BAGS&&e.default.createElement(\"div\",{className:\"shop_item_button\",onClick:function(e){e.stopPropagation(),n.CustomEvent.triggerClient(\"shop::tryOnBackpack\",a.item_id)}},e.default.createElement(\"p\",null,\"Примерить\"))));return i?e.default.createElement(d.TooltipClass,{text:i,html:!0,effect:\"solid\"},u):u})),e.default.createElement(\"div\",{className:\"shop_right\"},e.default.createElement(\"h6\",null,\"Баланс:\"),e.default.createElement(\"div\",{className:\"money-wrap-shop mb12\"},e.default.createElement(\"p\",{className:\"p-big\"},\"$\",y.system.numberFormat(m.CEF.user.money)),e.default.createElement(\"p\",{className:\"p-small\"},\"$\",y.system.numberFormat(m.CEF.user.bank))),e.default.createElement(\"h6\",null,\"Итого:\"),b.getAllPrice()?e.default.createElement(e.default.Fragment,null,e.default.createElement(\"h5\",null,\"$\",b.getAllPrice()),e.default.createElement(\"div\",{className:\"shop_buy\",onClick:function(e){e.preventDefault(),b.state.donate?b.buyItem():b.setState(N(N({},b.state),{},{showPay:!0}))}},e.default.createElement(\"img\",{src:i.default}),\"Купить\")):e.default.createElement(\"h5\",null,b.state.donate?e.default.createElement(\"img\",{className:\"shop-logo__coin\",src:c.default}):\"$\",\"0\"),e.default.createElement(\"div\",{className:\"shop_buyinfo\"},e.default.createElement(\"img\",{src:l.default}),e.default.createElement(\"h6\",null,\"Ваша \",e.default.createElement(\"strong\",null,\"корзина\"))),e.default.createElement(\"div\",{className:\"shop_buyitems\"},v.map(function(n,a){return e.default.createElement(\"div\",{key:a,className:\"shop_buyitem\"},e.default.createElement(\"div\",{className:\"shop_buyitempic\"},e.default.createElement(\"img\",{src:t.default[\"Item_\"+n.item_id],alt:\"\"})),e.default.createElement(\"span\",null,e.default.createElement(\"div\",{className:\"shop_buyitemup\"},e.default.createElement(\"p\",null,(0,r.getBaseItemNameById)(n.item_id)),e.default.createElement(\"h3\",null,b.state.donate?e.default.createElement(\"img\",{className:\"shop-logo__coin\",src:c.default}):\"$\",n.price)),e.default.createElement(\"div\",{className:\"shop_buyitemdown\"},e.default.createElement(\"img\",{src:u.default,onClick:function(){return b.putInCart(n.item_id,1)}}),e.default.createElement(\"h3\",null,n.inCart),e.default.createElement(\"img\",{src:s.default,onClick:function(){return b.putInCart(n.item_id,-1)}}))))})))))):e.default.createElement(e.default.Fragment,null)},b.state={active:!0,name:\"Premium Deluxe Shoper\",items:m.CEF.test?g(r.inventoryShared.items.map(function(e){return{item_id:e.item_id,count:10,price:e.defaultCost||1e3}})):[],shopType:[2,0],selectType:0,selectItem:-1},b._child=e.default.createRef(),b.initEvent=n.CustomEvent.register(\"cef:item_shop:init\",function(e,t,n,r,a,o){b.setState({shopId:e,name:t,items:n,donate:r,active:!0,shopType:[a,o],showPay:!1})}),b}return j(v)}();"},"sourceMaps":null,"error":null,"hash":"5c24b18f410532c1d8cb830fd4bfafeb","cacheData":{"env":{}}}