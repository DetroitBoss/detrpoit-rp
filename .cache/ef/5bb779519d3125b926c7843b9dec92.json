{"id":"wYuI","dependencies":[{"name":"D:\\DETROIT\\server\\tsconfig.json","includedInParent":true,"mtime":1660943058000},{"name":"D:\\DETROIT\\server\\.babelrc","includedInParent":true,"mtime":1660943058000},{"name":"D:\\DETROIT\\server\\package.json","includedInParent":true,"mtime":1697927911090},{"name":"react","loc":{"line":1,"column":33,"index":33},"parent":"D:\\DETROIT\\server\\src\\cef\\components\\Shop\\index.tsx","resolved":"D:\\DETROIT\\server\\node_modules\\react\\index.js"},{"name":"../../../shared/icons/*.png","loc":{"line":2,"column":18,"index":61},"parent":"D:\\DETROIT\\server\\src\\cef\\components\\Shop\\index.tsx","resolved":"D:\\DETROIT\\server\\src\\shared\\icons\\*.png"},{"name":"./style.less","loc":{"line":3,"column":7,"index":100},"parent":"D:\\DETROIT\\server\\src\\cef\\components\\Shop\\index.tsx","resolved":"D:\\DETROIT\\server\\src\\cef\\components\\Shop\\style.less"},{"name":"../../modules/custom.event","loc":{"line":4,"column":28,"index":145},"parent":"D:\\DETROIT\\server\\src\\cef\\components\\Shop\\index.tsx","resolved":"D:\\DETROIT\\server\\src\\cef\\modules\\custom.event.ts"},{"name":"../../../shared/inventory","loc":{"line":5,"column":94,"index":270},"parent":"D:\\DETROIT\\server\\src\\cef\\components\\Shop\\index.tsx","resolved":"D:\\DETROIT\\server\\src\\shared\\inventory.ts"},{"name":"../../../shared/business","loc":{"line":6,"column":39,"index":339},"parent":"D:\\DETROIT\\server\\src\\cef\\components\\Shop\\index.tsx","resolved":"D:\\DETROIT\\server\\src\\shared\\business.ts"},{"name":"./../Fuel/assets/bg.svg","loc":{"line":7,"column":15,"index":383},"parent":"D:\\DETROIT\\server\\src\\cef\\components\\Shop\\index.tsx","resolved":"D:\\DETROIT\\server\\src\\cef\\components\\Fuel\\assets\\bg.svg"},{"name":"./../ClothShop/assets/check.svg","loc":{"line":8,"column":18,"index":429},"parent":"D:\\DETROIT\\server\\src\\cef\\components\\Shop\\index.tsx","resolved":"D:\\DETROIT\\server\\src\\cef\\components\\ClothShop\\assets\\check.svg"},{"name":"./assets/cart.svg","loc":{"line":9,"column":17,"index":482},"parent":"D:\\DETROIT\\server\\src\\cef\\components\\Shop\\index.tsx","resolved":"D:\\DETROIT\\server\\src\\cef\\components\\Shop\\assets\\cart.svg"},{"name":"./assets/plus.svg","loc":{"line":10,"column":17,"index":521},"parent":"D:\\DETROIT\\server\\src\\cef\\components\\Shop\\index.tsx","resolved":"D:\\DETROIT\\server\\src\\cef\\components\\Shop\\assets\\plus.svg"},{"name":"./assets/minus.svg","loc":{"line":11,"column":18,"index":561},"parent":"D:\\DETROIT\\server\\src\\cef\\components\\Shop\\index.tsx","resolved":"D:\\DETROIT\\server\\src\\cef\\components\\Shop\\assets\\minus.svg"},{"name":"./assets/coin.svg","loc":{"line":12,"column":17,"index":601},"parent":"D:\\DETROIT\\server\\src\\cef\\components\\Shop\\index.tsx","resolved":"D:\\DETROIT\\server\\src\\cef\\components\\Shop\\assets\\coin.svg"},{"name":"../PayBox/PayBox","loc":{"line":13,"column":23,"index":646},"parent":"D:\\DETROIT\\server\\src\\cef\\components\\Shop\\index.tsx","resolved":"D:\\DETROIT\\server\\src\\cef\\components\\PayBox\\PayBox.tsx"},{"name":"../../modules/CEF","loc":{"line":14,"column":20,"index":687},"parent":"D:\\DETROIT\\server\\src\\cef\\components\\Shop\\index.tsx","resolved":"D:\\DETROIT\\server\\src\\cef\\modules\\CEF.ts"},{"name":"../Tooltip","loc":{"line":15,"column":29,"index":738},"parent":"D:\\DETROIT\\server\\src\\cef\\components\\Shop\\index.tsx","resolved":"D:\\DETROIT\\server\\src\\cef\\components\\Tooltip\\index.tsx"},{"name":"../HudBlock/images/svg/close.svg","loc":{"line":16,"column":18,"index":771},"parent":"D:\\DETROIT\\server\\src\\cef\\components\\Shop\\index.tsx","resolved":"D:\\DETROIT\\server\\src\\cef\\components\\HudBlock\\images\\svg\\close.svg"},{"name":"../../modules/system","loc":{"line":17,"column":23,"index":831},"parent":"D:\\DETROIT\\server\\src\\cef\\components\\Shop\\index.tsx","resolved":"D:\\DETROIT\\server\\src\\cef\\modules\\system.ts"}],"generated":{"js":"\"use strict\";Object.defineProperty(exports,\"__esModule\",{value:!0}),exports.ShopBlock=void 0;var e=v(require(\"react\")),t=E(require(\"../../../shared/icons/*.png\"));require(\"./style.less\");var n=require(\"../../modules/custom.event\"),r=require(\"../../../shared/inventory\"),a=require(\"../../../shared/business\"),o=E(require(\"./../Fuel/assets/bg.svg\")),i=E(require(\"./../ClothShop/assets/check.svg\")),l=E(require(\"./assets/cart.svg\")),u=E(require(\"./assets/plus.svg\")),s=E(require(\"./assets/minus.svg\")),c=E(require(\"./assets/coin.svg\")),m=require(\"../PayBox/PayBox\"),f=require(\"../../modules/CEF\"),d=require(\"../Tooltip\"),p=E(require(\"../HudBlock/images/svg/close.svg\")),y=require(\"../../modules/system\");function E(e){return e&&e.__esModule?e:{default:e}}function h(e){if(\"function\"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(h=function(e){return e?n:t})(e)}function v(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||\"object\"!=typeof e&&\"function\"!=typeof e)return{default:e};var n=h(t);if(n&&n.has(e))return n.get(e);var r={__proto__:null},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(\"default\"!==o&&{}.hasOwnProperty.call(e,o)){var i=a?Object.getOwnPropertyDescriptor(e,o):null;i&&(i.get||i.set)?Object.defineProperty(r,o,i):r[o]=e[o]}return r.default=e,n&&n.set(e,r),r}function b(e){return(b=\"function\"==typeof Symbol&&\"symbol\"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&\"function\"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?\"symbol\":typeof e})(e)}function _(e){return C(e)||O(e)||P(e)||g()}function g(){throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")}function P(e,t){if(e){if(\"string\"==typeof e)return w(e,t);var n={}.toString.call(e).slice(8,-1);return\"Object\"===n&&e.constructor&&(n=e.constructor.name),\"Map\"===n||\"Set\"===n?Array.from(e):\"Arguments\"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?w(e,t):void 0}}function O(e){if(\"undefined\"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e[\"@@iterator\"])return Array.from(e)}function C(e){if(Array.isArray(e))return w(e)}function w(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function S(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function N(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?S(Object(n),!0).forEach(function(t){T(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):S(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function T(e,t,n){return(t=k(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function I(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,\"value\"in r&&(r.writable=!0),Object.defineProperty(e,k(r.key),r)}}function j(e,t,n){return t&&I(e.prototype,t),n&&I(e,n),Object.defineProperty(e,\"prototype\",{writable:!1}),e}function k(e){var t=A(e,\"string\");return\"symbol\"==b(t)?t:t+\"\"}function A(e,t){if(\"object\"!=b(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||\"default\");if(\"object\"!=b(r))return r;throw new TypeError(\"@@toPrimitive must return a primitive value.\")}return(\"string\"===t?String:Number)(e)}function M(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}function B(e,t,n){return t=F(t),q(e,D()?Reflect.construct(t,n||[],F(e).constructor):t.apply(e,n))}function q(e,t){if(t&&(\"object\"==b(t)||\"function\"==typeof t))return t;if(void 0!==t)throw new TypeError(\"Derived constructors may only return object or undefined\");return x(e)}function x(e){if(void 0===e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return e}function D(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(D=function(){return!!e})()}function F(e){return(F=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function R(e,t){if(\"function\"!=typeof t&&null!==t)throw new TypeError(\"Super expression must either be null or a function\");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,\"prototype\",{writable:!1}),t&&W(e,t)}function W(e,t){return(W=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var Y=exports.ShopBlock=function(E){function h(E){var v;return M(this,h),(v=B(this,h,[E])).componentDidMount=function(){document.addEventListener(\"keydown\",v.handleKeyDown)},v.componentWillUnmount=function(){v.initEvent&&v.initEvent.destroy(),document.removeEventListener(\"keydown\",v.handleKeyDown)},v.handleKeyDown=function(e){switch(e.keyCode){case 27:return n.CustomEvent.triggerClient(\"shop::closeButton\"),void(v.state.showPay&&!0===v.state.showPay?v.setState(N(N({},v.state),{},{showPay:!1})):v.setState(N(N({},v.state),{},{active:!1})))}},v.buyItem=function(){var e=v.state.donate?{paytype:150,pin:\"\"}:v._child.current.canPay(v.getAllPrice());if(e){var t=_(v.state.items).filter(function(e){return e.inCart>0}).map(function(e){return[e.item_id,e.inCart]});0!==t.length&&(v.setState({showPay:!1}),n.CustomEvent.triggerServer(\"server:item_shop:buy_item\",v.state.shopId,t,e.paytype,e.pin))}},v.selectType=function(e){v.setState(N(N({},v.state),{},{selectType:e}))},v.putInCart=function(e,t){if(t>0&&v.state.items.find(function(t){return t.item_id===e}).count<=(v.state.items.find(function(t){return t.item_id===e}).inCart||0))return;var n=v.state.items.map(function(n){return n.item_id===e?N(N({},n),{},{inCart:n.inCart?n.inCart+t:t}):n});v.setState(N(N({},v.state),{},{items:n}))},v.getAllPrice=function(){var e=0;return v.state.items.map(function(t){t.inCart&&(e+=t.inCart*t.price)}),e},v.getCategorys=function(){var e=[];return v.state.items.map(function(t){var n=r.inventoryShared.get(t.item_id);if(!n)return console.log(\"getCategorys ITEM SHOP WRONG ITEM\");!1===e.some(function(e){return e.name===r.ITEM_TYPE_ARRAY[n.type]})&&e.push({index:n.type,name:r.ITEM_TYPE_ARRAY[n.type]})}),e},v.render=function(){var E=v.state,h=E.active,b=(E.name,v.state.items?v.state.items.filter(function(e){return e.inCart&&e.inCart>0}):[]),_=v.getCategorys(),g=v.state.items?v.state.items.filter(function(e){return r.inventoryShared.get(e.item_id)&&r.inventoryShared.get(e.item_id).type==_[v.state.selectType].index}):[];return h?e.default.createElement(\"div\",{className:\"shop_browser\"},e.default.createElement(\"div\",{className:\"shop_grid\"}),e.default.createElement(\"div\",{className:\"shop_bg\"},e.default.createElement(\"img\",{src:o.default})),e.default.createElement(\"div\",{className:\"shop_blur\"}),v.state.showPay&&!0===v.state.showPay?e.default.createElement(\"div\",{className:\"shop_paybox\"},e.default.createElement(\"div\",{className:\"shop_paybox_box\"},e.default.createElement(m.PayBox,{ref:v._child}),e.default.createElement(\"div\",{className:\"shop_buy\",onClick:v.buyItem},e.default.createElement(\"img\",{src:i.default}),\"Оплатить\"))):null,e.default.createElement(\"div\",{className:\"shop_main\"},e.default.createElement(\"button\",{className:\"all-close\",onClick:function(e){n.CustomEvent.triggerClient(\"shop::closeButton\"),f.CEF.gui.setGui(null)}},e.default.createElement(\"div\",null,e.default.createElement(\"img\",{src:p.default,alt:\"\"})),e.default.createElement(\"p\",null,\"Закрыть\")),e.default.createElement(\"h1\",null,a.BUSINESS_SUBTYPE_NAMES[v.state.shopType[0]][v.state.shopType[1]]),e.default.createElement(\"h2\",null,v.state.name),e.default.createElement(\"div\",{className:\"shop_box\"},e.default.createElement(\"div\",{className:\"shop_left\"},e.default.createElement(\"div\",{className:\"shop_types\"},_.length>1&&_.map(function(t,n){return e.default.createElement(\"div\",{key:n,className:\"shop_type \".concat(n==v.state.selectType?\"shop_type_select\":\"\"),onClick:function(){return v.selectType(n)}},t.name)}))),e.default.createElement(\"div\",{className:\"shop_center\"},g.map(function(a,o){var i=(0,r.getItemDesc)(a.item_id),l=r.inventoryShared.get(a.item_id),u=(r.ITEM_TYPE.WEAPON==l.type?r.inventoryShared.getWeaponConfigByItemId(a.item_id):r.ITEM_TYPE.WEAPON_MAGAZINE==l.type&&r.inventoryShared.getWeaponConfigByMagazine(a.item_id),e.default.createElement(\"div\",{key:o,className:\"shop_item \".concat(o==v.state.selectType?\"shop_item_select\":\"\"),onMouseEnter:function(){return v.setState(N(N({},v.state),{},{selectItem:o}))},onMouseLeave:function(){return v.setState(N(N({},v.state),{},{selectItem:-1}))},onClick:function(){return v.putInCart(a.item_id,1)}},e.default.createElement(\"div\",null,e.default.createElement(\"img\",{src:t.default[\"Item_\"+a.item_id],alt:\"\"})),e.default.createElement(\"p\",null,(0,r.getBaseItemNameById)(a.item_id)),[r.ITEM_TYPE.WATER,r.ITEM_TYPE.FOOD].includes(l.type)?e.default.createElement(\"p\",{className:\"desc\"},\"Объём: \",l.default_count,\" \",l.type==r.ITEM_TYPE.WATER?\"мл\":\"гр\"):e.default.createElement(e.default.Fragment,null),e.default.createElement(\"h3\",null,v.state.donate?e.default.createElement(\"img\",{className:\"shop-logo__coin\",src:c.default}):\"$\",a.price),l.type===r.ITEM_TYPE.BAGS&&e.default.createElement(\"div\",{className:\"shop_item_button\",onClick:function(e){e.stopPropagation(),n.CustomEvent.triggerClient(\"shop::tryOnBackpack\",a.item_id)}},e.default.createElement(\"p\",null,\"Примерить\"))));return i?e.default.createElement(d.TooltipClass,{text:i,html:!0,effect:\"solid\"},u):u})),e.default.createElement(\"div\",{className:\"shop_right\"},e.default.createElement(\"h6\",null,\"Баланс:\"),e.default.createElement(\"div\",{className:\"money-wrap-shop mb12\"},e.default.createElement(\"p\",{className:\"p-big\"},\"$\",y.system.numberFormat(f.CEF.user.money)),e.default.createElement(\"p\",{className:\"p-small\"},\"$\",y.system.numberFormat(f.CEF.user.bank))),e.default.createElement(\"h6\",null,\"Итого:\"),v.getAllPrice()?e.default.createElement(e.default.Fragment,null,e.default.createElement(\"h5\",null,\"$\",v.getAllPrice()),e.default.createElement(\"div\",{className:\"shop_buy\",onClick:function(e){e.preventDefault(),v.state.donate?v.buyItem():v.setState(N(N({},v.state),{},{showPay:!0}))}},e.default.createElement(\"img\",{src:i.default}),\"Купить\")):e.default.createElement(\"h5\",null,v.state.donate?e.default.createElement(\"img\",{className:\"shop-logo__coin\",src:c.default}):\"$\",\"0\"),e.default.createElement(\"div\",{className:\"shop_buyinfo\"},e.default.createElement(\"img\",{src:l.default}),e.default.createElement(\"h6\",null,\"Ваша \",e.default.createElement(\"strong\",null,\"корзина\"))),e.default.createElement(\"div\",{className:\"shop_buyitems\"},b.map(function(n,a){return e.default.createElement(\"div\",{key:a,className:\"shop_buyitem\"},e.default.createElement(\"div\",{className:\"shop_buyitempic\"},e.default.createElement(\"img\",{src:t.default[\"Item_\"+n.item_id],alt:\"\"})),e.default.createElement(\"span\",null,e.default.createElement(\"div\",{className:\"shop_buyitemup\"},e.default.createElement(\"p\",null,(0,r.getBaseItemNameById)(n.item_id)),e.default.createElement(\"h3\",null,v.state.donate?e.default.createElement(\"img\",{className:\"shop-logo__coin\",src:c.default}):\"$\",n.price)),e.default.createElement(\"div\",{className:\"shop_buyitemdown\"},e.default.createElement(\"img\",{src:u.default,onClick:function(){return v.putInCart(n.item_id,1)}}),e.default.createElement(\"h3\",null,n.inCart),e.default.createElement(\"img\",{src:s.default,onClick:function(){return v.putInCart(n.item_id,-1)}}))))})))))):e.default.createElement(e.default.Fragment,null)},v.state={active:!0,name:\"Premium Deluxe Shoper\",items:f.CEF.test?_(r.inventoryShared.items.map(function(e){return{item_id:e.item_id,count:10,price:e.defaultCost||1e3}})):[],shopType:[2,0],selectType:0,selectItem:-1},v._child=e.default.createRef(),v.initEvent=n.CustomEvent.register(\"cef:item_shop:init\",function(e,t,n,r,a,o){v.setState({shopId:e,name:t,items:n,donate:r,active:!0,shopType:[a,o],showPay:!1})}),v}return R(h,e.Component),j(h)}();"},"sourceMaps":null,"error":null,"hash":"67371e1cd268ae7f97d1fecc9e377640","cacheData":{"env":{}}}