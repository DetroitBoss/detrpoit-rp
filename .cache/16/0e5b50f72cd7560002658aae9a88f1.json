{"id":"WbKO","dependencies":[{"name":"D:\\DETROIT\\server\\tsconfig.json","includedInParent":true,"mtime":1660943058000},{"name":"D:\\DETROIT\\server\\.babelrc","includedInParent":true,"mtime":1660943058000},{"name":"D:\\DETROIT\\server\\package.json","includedInParent":true,"mtime":1697927911090},{"name":"./style.less","loc":{"line":1,"column":7,"index":7},"parent":"D:\\DETROIT\\server\\src\\cef\\components\\Fishing\\pulling\\pulling.tsx","resolved":"D:\\DETROIT\\server\\src\\cef\\components\\Fishing\\pulling\\style.less"},{"name":"react","loc":{"line":2,"column":33,"index":57},"parent":"D:\\DETROIT\\server\\src\\cef\\components\\Fishing\\pulling\\pulling.tsx","resolved":"D:\\DETROIT\\server\\node_modules\\react\\index.js"},{"name":"../../../modules/custom.event","loc":{"line":3,"column":28,"index":95},"parent":"D:\\DETROIT\\server\\src\\cef\\components\\Fishing\\pulling\\pulling.tsx","resolved":"D:\\DETROIT\\server\\src\\cef\\modules\\custom.event.ts"},{"name":"../../../../shared/fish","loc":{"line":4,"column":42,"index":171},"parent":"D:\\DETROIT\\server\\src\\cef\\components\\Fishing\\pulling\\pulling.tsx","resolved":"D:\\DETROIT\\server\\src\\shared\\fish.ts"},{"name":"../assets/*.png","loc":{"line":5,"column":16,"index":215},"parent":"D:\\DETROIT\\server\\src\\cef\\components\\Fishing\\pulling\\pulling.tsx","resolved":"D:\\DETROIT\\server\\src\\cef\\components\\Fishing\\assets\\*.png"},{"name":"../assets/*.svg","loc":{"line":6,"column":16,"index":251},"parent":"D:\\DETROIT\\server\\src\\cef\\components\\Fishing\\pulling\\pulling.tsx","resolved":"D:\\DETROIT\\server\\src\\cef\\components\\Fishing\\assets\\*.svg"},{"name":"../../../modules/CEF","loc":{"line":7,"column":20,"index":291},"parent":"D:\\DETROIT\\server\\src\\cef\\components\\Fishing\\pulling\\pulling.tsx","resolved":"D:\\DETROIT\\server\\src\\cef\\modules\\CEF.ts"}],"generated":{"js":"\"use strict\";Object.defineProperty(exports,\"__esModule\",{value:!0}),exports.FishPulling=void 0,require(\"./style.less\");var e=l(require(\"react\")),t=require(\"../../../modules/custom.event\"),r=require(\"../../../../shared/fish\"),n=o(require(\"../assets/*.png\")),s=o(require(\"../assets/*.svg\")),i=require(\"../../../modules/CEF\");function o(e){return e&&e.__esModule?e:{default:e}}function a(e){if(\"function\"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(a=function(e){return e?r:t})(e)}function l(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||\"object\"!=typeof e&&\"function\"!=typeof e)return{default:e};var r=a(t);if(r&&r.has(e))return r.get(e);var n={__proto__:null},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(\"default\"!==i&&{}.hasOwnProperty.call(e,i)){var o=s?Object.getOwnPropertyDescriptor(e,i):null;o&&(o.get||o.set)?Object.defineProperty(n,i,o):n[i]=e[i]}return n.default=e,r&&r.set(e,n),n}function u(e){return(u=\"function\"==typeof Symbol&&\"symbol\"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&\"function\"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?\"symbol\":typeof e})(e)}function f(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}function c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,g(n.key),n)}}function h(e,t,r){return t&&c(e.prototype,t),r&&c(e,r),Object.defineProperty(e,\"prototype\",{writable:!1}),e}function g(e){var t=p(e,\"string\");return\"symbol\"==u(t)?t:t+\"\"}function p(e,t){if(\"object\"!=u(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||\"default\");if(\"object\"!=u(n))return n;throw new TypeError(\"@@toPrimitive must return a primitive value.\")}return(\"string\"===t?String:Number)(e)}function d(e,t,r){return t=_(t),v(e,y()?Reflect.construct(t,r||[],_(e).constructor):t.apply(e,r))}function v(e,t){if(t&&(\"object\"==u(t)||\"function\"==typeof t))return t;if(void 0!==t)throw new TypeError(\"Derived constructors may only return object or undefined\");return m(e)}function m(e){if(void 0===e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return e}function y(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(y=function(){return!!e})()}function _(e){return(_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function P(e,t){if(\"function\"!=typeof t&&null!==t)throw new TypeError(\"Super expression must either be null or a function\");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,\"prototype\",{writable:!1}),t&&b(e,t)}function b(e,t){return(b=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var E=1,k=97,I=3,S=55,w=5,C=.15,O=3,T=97,M=95,j=5,N=10,F=exports.FishPulling=function(o){function a(e){var n;return f(this,a),(n=d(this,a,[e])).handleKeyUp=function(e){e.keyCode==n.state.keysToPress[0].keyCode?n.setState({fishMovingProgress:n.state.fishMovingProgress-w}):e.keyCode==n.state.keysToPress[1].keyCode?n.setState({tensionProgress:n.state.tensionProgress+j}):(n.sendResultToClient(!1),n.stopGame())},n.state={show:!1,fishMovingProgress:0,tensionProgress:0,fishToCatch:r.FISHES[0],resultSended:!1,keysToPress:r.FISH_PULLING_KEYS[0]},n._ev=t.CustomEvent.register(\"fish:pulling:start\",function(e,t){n.startGame(e,t)}),n}return P(a,e.Component),h(a,[{key:\"getFishSpeed\",value:function(){return this.state.fishToCatch.expPerCatch/10*E}},{key:\"startGame\",value:function(e,t){this.setState({show:!0,tensionProgress:M,fishMovingProgress:S,fishToCatch:e,resultSended:!1,keysToPress:t}),this._fishInterval&&clearInterval(this._fishInterval),this._tensionInterval&&clearInterval(this._tensionInterval),this.addEventListener(),this.startTensionMoving(),this.startFishMoving()}},{key:\"startFishMoving\",value:function(){var e=this;this._fishInterval=setInterval(function(){e.state.fishMovingProgress>=k&&(i.CEF.alert.setAlert(\"error\",\"Вы упустили рыбу\"),e.sendResultToClient(!1),e.stopGame()),e.state.fishMovingProgress<=I&&(e.sendResultToClient(!0),e.stopGame()),e.setState({fishMovingProgress:e.state.fishMovingProgress+e.getFishSpeed()})},N)}},{key:\"startTensionMoving\",value:function(){var e=this;this._tensionInterval=setInterval(function(){(e.state.tensionProgress<=O||e.state.tensionProgress>=T)&&(i.CEF.alert.setAlert(\"error\",\"Упс! Вы порвали леску\"),e.sendResultToClient(!1),e.stopGame()),e.setState({tensionProgress:e.state.tensionProgress-C})},N)}},{key:\"stopGame\",value:function(){this._fishInterval&&clearInterval(this._fishInterval),this._tensionInterval&&clearInterval(this._tensionInterval),this.removeEventListener(),this.setState({show:!1})}},{key:\"addEventListener\",value:function(){document.addEventListener(\"keyup\",this.handleKeyUp)}},{key:\"removeEventListener\",value:function(){document.removeEventListener(\"keyup\",this.handleKeyUp)}},{key:\"sendResultToClient\",value:function(e){t.CustomEvent.triggerClient(\"fishing:pulling:done\",e,this.state.fishToCatch.itemId),this.setState({resultSended:!0})}},{key:\"componentWillUnmount\",value:function(){var e;this.state.resultSended||this.sendResultToClient(!1),this.stopGame(),null===(e=this._ev)||void 0===e||e.destroy()}},{key:\"render\",value:function(){return e.default.createElement(\"div\",{className:\"fishing\",style:{display:this.state.show?\"flex\":\"none\"}},e.default.createElement(\"div\",{className:\"fishing__helpImage\"},e.default.createElement(\"img\",{src:n.default.helpImage,alt:\"\"}),e.default.createElement(\"span\",null,\"Не дай ей сорваться!\")),e.default.createElement(\"div\",{className:\"fishing__help\"},\"Нажимай \",e.default.createElement(\"span\",null,this.state.keysToPress[0].keyName),\" чтобы не упустить рыбу и \",e.default.createElement(\"span\",null,this.state.keysToPress[1].keyName),\" чтобы держать леску\"),e.default.createElement(\"div\",{className:\"fishing-progress__left\"},e.default.createElement(\"img\",{src:s.default.progressImageL,className:\"fishing-progress__image\",alt:\"\"}),e.default.createElement(\"img\",{src:n.default.helpImage,className:\"fishing-progress__help\",alt:\"\"}),e.default.createElement(\"div\",{className:\"fishing-progress__bar \".concat(this.state.fishMovingProgress<69?\"fishing-green\":null)},e.default.createElement(\"div\",{style:{height:this.state.fishMovingProgress+\"%\"}}))),e.default.createElement(\"div\",{className:\"fishing-progress__right\"},e.default.createElement(\"img\",{src:s.default.progressImage,className:\"fishing-progress__image\",alt:\"\"}),e.default.createElement(\"img\",{src:n.default.helpImage,className:\"fishing-progress__help\",alt:\"\"}),e.default.createElement(\"div\",{className:\"fishing-progress__bar \".concat(this.state.tensionProgress>69&&this.state.tensionProgress<T?\"fishing-green\":null)},e.default.createElement(\"div\",{style:{height:this.state.tensionProgress+\"%\"}}))))}}])}();"},"sourceMaps":null,"error":null,"hash":"62880b623004db082efb7033403712e8","cacheData":{"env":{}}}